---
title: "Schema-Driven Development における Mocking"
emoji: "📌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

- 課題の1つ目として、一部外部 API 呼び出しを行うためのテストが存在している。外部に依存した状態だと外部 API が予告なしに停止したりする可能性があるため、テストが脆弱になる。
- 2つ目は、Schema 駆動開発をしている。フロントエンドは Next.js、バックエンドは NestJS。ロジックを実装するまでは Mock が必要になる。
- 開発環境は Dev Containers を使用している。
- WireMock を導入した。
- WireMock を Docker で起動。
- WireMock を Proxy として使用。WireMock にないリクエストは API Server で処理。開発環境と QA 環境も同じ構成。ECS に Mock Cluster を構築。
- Mock が返している Response なのかを判断できるよう Response の内容にダミーとハッキリわかる文字を含める。
- 私は前職で WireMock を使用した経験があり、このケースの解決に最適な選択肢だと思った。
- 開発のフローは次のとおり。開発チームでスキーマを決める。決めたスキーマの JSON を用意する。WireMock のフォルダに JSON を配置する。WireMock を Rest する。

