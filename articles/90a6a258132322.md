---
title: "Kubernetes: Upgrading Argo CD"
emoji: "⚙️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["googlecloud", "gke", "argocd", "gc24"]
published: false
---
Argo CD の version up について。個人的な memo として。

Argo CD の maintenance が滞っていたため、Argo CD の version up と cluster の version up に対応する。

## Upgrading　Argo CD

- `stable` を apply する。

https://argo-cd.readthedocs.io/en/stable/operator-manual/upgrading/overview/

## Recreate Ingress

- `argocd-server` が変更になっているため service discovery を含め、再作成する。

## Deprecated resource warning

https://cloud.google.com/kubernetes-engine/docs/deprecations/podsecuritypolicy?hl=ja

API `/apis/policy/v1beta1/podsecuritypolicies` が削除された。1.25 において。

以下の message が表示される。

:::message alert
過去 30 日間に、クラスタ内の API クライアントが、Kubernetes 1.25 で削除された API を呼び出そうとしました。現在、これらの API は利用できません。これらの API を使用する機能は、正常に動作しないおそれがあります。
:::

## Exclude PodSecurityPolicy from monitoring

- `PodSecurityPolicy` を監視から除外する。

https://github.com/argoproj/argo-cd/issues/12382

https://argo-cd.readthedocs.io/en/latest/operator-manual/declarative-setup/#resource-exclusioninclusion

