---
title: "Managing Cloud Computing Costs with FinOps"
emoji: "ğŸ’°"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["terraform", "iac", "finops"]
published: true
---
IaC ã«å–ã‚Šçµ„ã¿å§‹ã‚ã¦æ•°ãƒ¶æœˆã€‚

engineer ãŒäºˆæƒ³ä»¥ä¸Šã«é©å¿œã—ã¦ã„ã‚‹ã¨æ€ã†ã€‚

å¬‰ã—ã„é©šãã ã£ãŸã€‚

Shift-left ã®é‡è¦æ€§ã‚’å†èªè­˜ã—ãŸã€‚ä¾‹ãˆã°ã€å¾Œã«ãªã£ã¦ IaC ã«ã™ã‚‹ã®ã¯ import ã®æ‰‹é–“ã‚‚ã‚ã‚‹ã€‚

ä¸€æ–¹ã§ã€ã‚³ã‚¹ãƒˆã«ã¤ã„ã¦æ„è­˜ã‚’é«˜ã‚ã™ãã‚‹ã®ã‚‚å±é™ºã€‚æœ¬è³ªã¯ä¾¡å€¤ã®æä¾›ã€‚ç¹Šç´°ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã€‚

æ”¹ã‚ã¦ FinOps ã®ä¸»è¦æ§‹æˆè¦ç´ ã«ã¤ã„ã¦è‡ªåˆ†ãŒå‡ºæ¥ã¦ã„ã‚‹ã“ã¨ã‚’ã¾ã¨ã‚ã‚‹ã€‚

https://cloud.google.com/learn/what-is-finops

## tl;dr
- FinOps ã®ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ Google Cloud ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚
- Google ã®æå”±ã™ã‚‹ FinOps ä¸»è¦æ§‹æˆè¦ç´ ã®ã€€50 ï¼…ãã‚‰ã„ã¯ç€æ‰‹ã§ãã¦ã„ã‚‹ã€‚æ®‹ã‚Šã® 50 ï¼…ã‚’é€²ã‚ã‚‹ãŸã‚ã€ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¼·åŒ–ãŒå¿…è¦ã€‚

## Five key

|No.|Key|Status|
|----|----|----|
|1|Accountability and enablement|`todo`|
|2|Measurement and realization|`in progress`|
|3|Cost optimization|`in progress`|
|4|Planning and forecasting|`todo`|
|5|Tools and accelerators|`in progress`|

### "Measurement and realization"
- ä»Šå¾Œã€åˆ©ç”¨çŠ¶æ³ã‚’è©³ç´°ã«æŠŠæ¡ã™ã‚‹ã“ã¨ãŒå¿…è¦ã«ãªã‚‹ã¨æ€ã†ã€‚ç¾çŠ¶ single tenant ã§ `dev` `stg` `prod` ã‚’é‹ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€GKE ã® Cluster ã‚‚å¢—ãˆã¦ã„ã‚‹ã€‚

|Item|||Status|
|----|----|----|----|
|æ—¢å­˜ã®ã‚³ã‚¹ãƒˆã®æŠŠæ¡|label ã¨ tag ä»˜ã‘|Terraform ã® review é …ç›®ã¨ã™ã‚‹|`todo`|

### "Cost optimization"
- Infracost[^5] ã¯ traffic ã‚„ schedule ã«ä¾å­˜ã™ã‚‹ resource ã¯ HCL ã‹ã‚‰ç®—å‡ºã§ããªã„ã€‚pricing calculator[^9] ãŒå¿…è¦ã€‚
- æ§‹æˆå›³ã¯ Pluralith[^4] ã§é‹ç”¨ã§ããã†ã€‚draw.io ã¯è¨­è¨ˆæ™‚ã«ä½¿ã„ã€è¨­è¨ˆãŒå›ºã¾ã£ãŸã‚‰ HCL -> Pluralith ã¨ã„ã†å½¢ã§é€²ã‚ã‚‹ã€‚
- Recommender API ã‚’ä½¿ç”¨ã—ãŸç®¡ç†ã¯æœªç€æ‰‹ã€‚project æ¨ªæ–­çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ä»•çµ„ã¿ã‚’è€ƒãˆãŸã„ã€‚
- Terraformï¼ˆHCLï¼‰ã¸ã®ç§»è¡Œã¨å°å…¥ã¯é€²ã‚ã‚‰ã‚Œãã†ã€‚ä¸€æ–¹ã§ HCL ã‚’ç¶­æŒã—ã¦ãæ–½ç­–ãŒå¿…è¦ã€‚å…·ä½“çš„ã«ã¯ console ã§ã® maintenance ã«ã‚ˆã‚‹å·®åˆ†ã®ç®¡ç†ãŒå•é¡Œã«ãªã‚‹ã€‚driftctl[^10] ã®é‹ç”¨ã‚’æ¤œè¨ã™ã‚‹ã€‚

|Item|||Status|
|----|----|----|----|
|Resource optimization|snapshot ã® rotation|Terraform ã® review é …ç›®ã¨ã™ã‚‹|`todo`|
|^|idle çŠ¶æ…‹ã® instance/node ã®åœæ­¢|Recommender[^3] ã®æ´»ç”¨|`todo`|
|^|over spec ã® database instance|Recommender[^3] ã®æ´»ç”¨|`todo`|
|Pricing optimization|æ§‹æˆå¤‰æ›´ã«ã‚ˆã‚‹ã‚³ã‚¹ãƒˆã¸ã®å½±éŸ¿ã®ç®¡ç†|Infracost[^5]|`in progress`|
|^|æ¨å¥¨äº‹é …ã®é©ç”¨|Recommendation Hub[^1]|`todo`|
|^|ç¢ºå®šåˆ©ç”¨å‰²å¼•ã®é©ç”¨||`in progress`|
|Architecture optimization|è¦–è¦šçš„ãªè¨­è¨ˆã®ç®¡ç†|Pluralith[^4]|`in progress`|

### "Tools and accelerators"
- dashboard ã«ã¤ã„ã¦ä»Šã®ã¨ã“ã‚çµ„ç¹”çš„ã«åˆ©ç”¨ã•ã‚Œã¦ã„ãªã„ã€‚åˆ©ç”¨æ–™ãŒä»Šå¾Œè†¨ã‚‰ã‚“ã§ãã‚‹ã¨å¿…è¦æ€§ãŒé«˜ã¾ã‚‹ã¨æ€ã†ã€‚

|Item|||Status|
|----|----|----|----|
|Deploying Google Cloud cost-management tools to analyze real-time billing and cost data|Export Cloud Billing data to BigQuery[^6]||`done`|
|Developing a reporting dashboard to manage cloud spend and value tracking|çµ„ç¹”ãƒ»project æ¯ã«é›†è¨ˆã•ã‚ŒãŸ Billing data ã® Connected Sheets[^8] ã®æä¾›|çµŒç†éƒ¨é–€ã¨ã®é€£æº|`done`|
|Implementing automation scripts to set account guardrails and budget alerts|Budget alerts[^7]||`done`|

## BTW
ã“ã‚Œã‚’æ›¸ã„ã¦ã„ã‚‹ã®ã¯ Aya[^2] ã«è‹¦æˆ¦ã—ã¦ã„ã‚‹ã‹ã‚‰ã€‚

ã€Œãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã®å®Ÿè£…ã§ã‚‚ã€ã¨è»½ã„æ°—æŒã¡ã§å§‹ã‚ãŸãŒã€ã€eBPF ã¨ Rust ã¯å‹•ã‹ã™ã®ã•ãˆã‚‚ä¸€è‹¦åŠ´ã€‚

eBPF ãŒå½¢ã«ãªã£ãŸã‚‰æ–‡å­—ãŠã“ã—ã—ãŸã„ã€‚

[^1]: https://cloud.google.com/recommender/docs/quickstart-recommendation-hub?hl=ja
[^2]: https://aya-rs.dev/
[^3]: https://cloud.google.com/recommender/docs/overview?hl=ja
[^4]: https://www.pluralith.com/
[^5]: https://www.infracost.io/
[^6]: https://cloud.google.com/billing/docs/how-to/export-data-bigquery?hl=ja
[^7]: https://cloud.google.com/billing/docs/how-to/budgets?hl=ja
[^8]: https://cloud.google.com/bigquery/docs/connected-sheets?hl=ja
[^9]: https://cloud.google.com/products/calculator?hl=ja
[^10]: https://docs.driftctl.com/0.40.0
